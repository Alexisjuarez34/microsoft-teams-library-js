{
  "$id": "/ExportedReturnFunction",
  "type": "object",
  "title": "Exported Return Function",
  "description": "Functions that consumers of your capability can call to retrieve data from the host. These functions will send some data to the host and return a `Promise`. Developers can `await` that `Promise`; when the `Promise` resolves the call has been completed successfully and any data returned as a result of the call can be retrieved.",
  "properties": {
    "name": {
      "$comment": "The name of the interface, this will be visible to external developers",
      "type": "string",
      "minLength": 3,
      "maxLength": 30
    },
    "comment": {
      "$comment": "A brief, descriptive explanation of what this function does that will be surfaced to consumers of your capability.",
      "type": "string",
      "minLength": 15,
      "maxLength": 1000
    },
    "returns": {
      "$comment": "The return `type` of this function that will be passed back to developers as `Promise<returns>`. If your function doesn't need to pass data back to the developer and instead just wants to pass back whether or not it was successful, set this value to `void`",
      "type": "string",
      "minLength": 3,
      "maxLength": 30
    },
    "returnComment": {
      "$comment": "A brief, descriptive explanation of what this function returns to callers.",
      "type": "string",
      "minLength": 15,
      "maxLength": 1000
    },
    "throwsComment": {
      "$comment": "A brief, descriptive explanation any errors that this function might throw and what callers should do with each.",
      "type": "string",
      "minLength": 15,
      "maxLength": 1000
    },
    "limitedToFrameContexts": {
      "$comment": "If this function is only available in certain frame contexts, list them here. If this function is available in all frame contexts, leave this value as `null`",
      "type": "array",
      "items": {
        "type": "object",
        "title": "Frame Context",
        "$comment": "A frame context in which this function is available.",
        "properties": {
          "frameContext": {
            "type": "string",
            "enum": ["content", "authentication", "settings", "remove", "task", "sidePanel", "stage", "meetingStage"]
          }
        }
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "requiredParameters": {
      "$comment": "A list of parameters that are required to be passed to this function. If no mandatory parameters are required, leave this value as `null`",
      "type": "array",
      "items": { "$ref": "/Parameter" },
      "minItems": 1,
      "uniqueItems": true
    },
    "optionalParameters": {
      "$comment": "A list of parameters may *optionally* to be passed to this function. If no optional parameters are required, leave this value as `null`",
      "type": "array",
      "items": { "$ref": "/Parameter" },
      "minItems": 1,
      "uniqueItems": true
    },
    "dataForHost": {
      "$comment": "A list of parameters are passed to the host",
      "type": "array",
      "items": { "$ref": "/DataForHost" },
      "minItems": 1,
      "uniqueItems": true
    },
    "dataFromHost": {
      "$ref": "/DataFromHost"
    }
  },
  "required": ["name", "comment", "returns", "returnComment"]
}